<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: controllers/ScoresByDate.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: controllers/ScoresByDate.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Función que se encarga de manejar los datos de la estadistica de ganancias por fecha
 * @namespace ScoresByDate
 */
class ScoresByDate {

  /**
   * Crea la clase
   */
  constructor() {
    this.labels = []
    this.generalLabels = []
    this.totalByTable = []
  }

  /**
   * Función que se encarga de sacar los labels de los datos
   * @param {Object} data Datos obtenidos de la API
   * @returns {Object} Labels de la estadistica
   */
  getLables( data ) {
    let labels = []
    let generalLabels = []

    
    data.map( table => {
      generalLabels.push( table.tableId )
      table.scores.map( score => {
        if ( labels.indexOf( score.time ) === -1 ) {
          labels.push( score.time )
        }
      } )
    } )

    labels.sort(this.compare)
    
    this.generalLabels = generalLabels
    this.labels = labels

    return { labels, generalLabels }
  }

  /**
   * Función que se encarga de sacar los datasets a partir de los datos obtenidos
   * @param {Object} data Datos obtenidos de la API
   * @returns {Object} Datasets de la estadistica
   */
  getDatasets( data ) {
    let datasets = []
    let totalByTable = []

    data.map( table => {
      const tableTotal = this.getTotalByTable( table.scores )
      totalByTable.push( tableTotal )
      
      let data = []
      for (let index = 0; index &lt; this.labels.length; index++) {
        data[index] = 0
      }

      table.scores.map( score => {
       data[ this.labels.indexOf(score.time) ] = score.amount / 100 
      } )

      const { rgb, rgba } = this.getRandomRGBColor()
      let dataset = {
        data,
        label: table.tableId,
        fill: true,
        borderColor: rgb,
        backgroundColor: rgba,
        pointRadius:4,
        pointBackgroundColor: rgb,
      }

      datasets.push( dataset )    
    } )
    
    totalByTable.push(0)
    
    return { datasets, totalByTable }
  }

  /**
   * Funcion que se encarga de calcular el total de ganancias
   * @param {Array} table Ganancias de cada una de las mesas
   * @returns {Number} Ganancias totales
   */
  getTotalByTable( table ) {
    let total = 0
    
    table.map( score => total += ( score.amount / 100) )

    return total
  }

  /**
   * Función que se encarga de comparar fechas en string
   * @param {String} a Fecha 1 
   * @param {String} b Fecha 2
   */
   compare(a,b) {
    var time1 = parseFloat(a.replace(':','.').replace(/[^\d.-]/g, ''));
    var time2 = parseFloat(b.replace(':','.').replace(/[^\d.-]/g, ''));

    if (time1 &lt; time2) return -1;
    if (time1 > time2) return 1;
    return 0;
  }

  /**
   * Función que se encarga de generar un color random en formato RGBa
   * @returns {String} Color en formato RGBA
   */
  getRandomRGBColor() {
    const red = Math.floor(Math.random() * 255)
    const green = Math.floor(Math.random() * 255)
    const blue = Math.floor(Math.random() * 255 )
    const alpha = .15

    const rgb = `rgb(${red}, ${green}, ${blue})`
    const rgba = `rgba(${red}, ${green}, ${blue}, ${alpha})`

    return { rgb, rgba }
  }
}

module.exports = ScoresByDate</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Api.html">Api</a></li><li><a href="AppConfiguration.html">AppConfiguration</a></li><li><a href="ErrorManagment.html">ErrorManagment</a></li><li><a href="FingerprintSDKTest.html">FingerprintSDKTest</a></li><li><a href="Generalconfigurations_.html">Generalconfigurations</a></li><li><a href="GlobalHeader.html">GlobalHeader</a></li><li><a href="Login.html">Login</a></li><li><a href="PromotionsManagment.html">PromotionsManagment</a></li><li><a href="Records.html">Records</a></li><li><a href="RolesManagment.html">RolesManagment</a></li><li><a href="ScoresByDate.html">ScoresByDate</a></li><li><a href="ScoresByDateRange.html">ScoresByDateRange</a></li><li><a href="Stadistics.html">Stadistics</a></li><li><a href="UsersManagment.html">UsersManagment</a></li></ul><h3>Namespaces</h3><ul><li><a href="GeneralConfigurations.html">GeneralConfigurations</a></li><li><a href="PageHeader.html">PageHeader</a></li><li><a href="Record.html">Record</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Wed Jul 11 2018 12:50:50 GMT-0500 (CDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
